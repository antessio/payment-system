<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
		http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-latest.xsd
		http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">
<changeSet author="antessio" id="202302011119">
    <createTable tableName="top-up" >
        <column name="id" type="UUID">
            <constraints nullable="false" primaryKey="true"/>
        </column>
        <column name="type" type="VARCHAR(255)"/>
        <column name="amountUnit" type="bigint"/>
        <column name="amountCurrency" type="VARCHAR(255)"/>
        <column name="insertDate" type="TIMESTAMP WITHOUT TIME ZONE" defaultValue="now()"/>
        <column name="updateDate" type="TIMESTAMP WITHOUT TIME ZONE"/>
        <column name="version" type="bigint" defaultValue="0"/>
    </createTable>
    <createTable tableName="bank-to-wallet-top-up" >
        <column name="topUpId" type="UUID">
            <constraints nullable="false" primaryKey="true"/>
        </column>
        <column name="fromBankAccountId" type="VARCHAR(255)"/>
        <column name="toWalletId" type="VARCHAR(255)"/>
        <column name="insertDate" type="TIMESTAMP WITHOUT TIME ZONE" defaultValue="now()"/>
        <column name="updateDate" type="TIMESTAMP WITHOUT TIME ZONE"/>
        <column name="version" type="bigint" defaultValue="0"/>
    </createTable>
    <createTable tableName="top-up-bank-transfer" >
        <column name="topUpId" type="UUID">
            <constraints nullable="false" primaryKey="true"/>
        </column>
        <column name="bankTransferId" type="VARCHAR(255)"/>
        <column name="bankTransferStatus" type="VARCHAR(255)"/>
        <column name="insertDate" type="TIMESTAMP WITHOUT TIME ZONE" defaultValue="now()"/>
        <column name="updateDate" type="TIMESTAMP WITHOUT TIME ZONE"/>
        <column name="version" type="bigint" defaultValue="0"/>
    </createTable>
    <createTable tableName="top-up-wallet-transfer" >
        <column name="topUpId" type="UUID">
            <constraints nullable="false" primaryKey="true"/>
        </column>
        <column name="walletTransferId" type="VARCHAR(255)"/>
        <column name="walletTransferStatus" type="VARCHAR(255)"/>
        <column name="insertDate" type="TIMESTAMP WITHOUT TIME ZONE" defaultValue="now()"/>
        <column name="updateDate" type="TIMESTAMP WITHOUT TIME ZONE"/>
        <column name="version" type="bigint" defaultValue="0"/>
    </createTable>

    <addForeignKeyConstraint
            constraintName="FK_top-up-bank-to-wallet-topup"
            baseTableName="top-up"
            baseColumnNames="id"
            referencedTableName="bank-to-wallet-top-up"
            referencedColumnNames="topUpId"
            />
    <addForeignKeyConstraint
            constraintName="FK_top-up-wallet-transfer"
            baseTableName="top-up"
            baseColumnNames="id"
            referencedTableName="top-up-wallet-transfer"
            referencedColumnNames="topUpId"
             />
    <addForeignKeyConstraint
            constraintName="FK_top-up-bank-transfer"
            baseTableName="top-up"
            baseColumnNames="id"
            referencedTableName="top-up-bank-transfer"
            referencedColumnNames="topUpId"
            />
    <createIndex indexName="top-up-wallet-transfer__walletTransferId"
                 tableName="top-up-wallet-transfer"
                 unique="true" >
        <column name="walletTransferId"/>
    </createIndex>
    <createIndex indexName="top-up-bank-transfer__bankTransferId"
                 tableName="top-up-bank-transfer"
                 unique="true" >
        <column name="bankTransferId"/>
    </createIndex>
</changeSet>
</databaseChangeLog>